\documentclass{book}
\input{preamble}
\begin{document}

\begin{verbatim}
\section*{Exercises}
\subsection*{Strange Loops}
The following system, based on a system called $\textsf{\textbf{Miu}}$, is perhaps famously mentioned in Douglas Hofstadter's book, \emph{G\"{o}del, Escher, Bach}.
  
  \begin{displaymath}
    \inferrule{\ }{\pred{\mathtt{MI}}{\textsf{\textbf{Miu}}}}{1} \quad \inferrule{\pred{x\mathtt{I}}{\textsf{\textbf{Miu}}}}{\pred{x\mathtt{IU}}{\textsf{\textbf{Miu}}}}{2} \quad
    \inferrule{\pred{\mathtt{M}x}{\textsf{\textbf{Miu}}}}{\pred{\mathtt{M}x x}{\textsf{\textbf{Miu}}}}{3} \quad
    \inferrule{\pred{x \mathtt{III} y}{\textsf{\textbf{Miu}}}}{\pred{x \mathtt{U} y}{\textsf{\textbf{Miu}}}}{4} \quad
        \inferrule{\pred{x \mathtt{UU} y}{\textsf{\textbf{Miu}}}}{\pred{x y}{\textsf{\textbf{Miu}}}}{5} 
  \end{displaymath}

\begin{ExerciseList}
   \Exercise Is $\pred{\mathtt{MUII}}{\textsf{\textbf{Miu}}}$ derivable? If so, show the derivation tree. If not, explain why not.
   \Answer
    \begin{displaymath}
        \inferrule{\inferrule{\inferrule{\inferrule{\inferrule{\inferrule{\inferrule{\inferrule{\ }{\pred{\mathtt{MI}}{\textsf{\textbf{Miu}}}}{1}}
                                     {\pred{\mathtt{MII}}{\textsf{\textbf{Miu}}}}{3}}
                                {\pred{\mathtt{MIIII}}{\textsf{\textbf{Miu}}}}{3}}
                           {\pred{\mathtt{MIIIIIIII}}{\textsf{\textbf{Miu}}}}{3}}
                      {\pred{\mathtt{MIIIIIIIIU}}{\textsf{\textbf{Miu}}}}{2}}
                 {\pred{\mathtt{MIIIIIUU}}{\textsf{\textbf{Miu}}}}{5}}{\pred{\mathtt{MIIIII}}{\textsf{\textbf{Miu}}}}{4}}
            {\pred{\mathtt{MUII}}{\textsf{\textbf{Miu}}}}{4}
      \end{displaymath}
   
    \Exercise  Is $\inferrule{\pred{x\mathtt{IU}}{\textsf{\textbf{Miu}}}}{\pred{x\mathtt{I}}{\textsf{\textbf{Miu}}}}$ admissible? Is it derivable? Justify your answer.
    \Answer
      It is not derivable, but it is admissible. It is not derivable because there is no way to construct a tree that looks like this:
     
     \begin{displaymath} 
      \inferrule{\inferrule{\pred{x\mathtt{IU}}{\textsf{\textbf{Miu}}}}{\vdots}}{\pred{x\mathtt{I}}{\textsf{\textbf{Miu}}}}
    \end{displaymath}
      
      It is, however, \emph{admissible} because it does not change the language \textsf{\textbf{Miu}}. There is no string $x$ that could be judged $\pred{x}{\textsf{\textbf{Miu}}}$ with this rule that could not be so judged without it. We could show this by proving the rule using rule induction.

    \Exercise[difficulty = 2] Perhaps famously, $\pred{\mathtt{MU}}{\textsf{\textbf{Miu}}}$ is not admissible. Prove this using rule induction.
    \emph{Hint}: Try proving something related to the number of $\mathtt{I}$s in the string.
    \Answer
      We will prove that the number of $\mathtt{I}$s in any string in $\textsf{\textbf{Miu}}$ is not divisible by three.
      Seeing as $\mathtt{MU}$ has zero $\mathtt{I}$s (a multiple of three), if we prove the above, we prove that $\mathtt{MU}$ is not admissible.
      
      \begin{proof}[Base Case (From rule 1)]
        $\;$ We see that the string $\mathtt{MI}$ has only one $\mathtt{I}$, which is not a multiple of three, hence we have shown our goal.
        
        \emph{Inductive case (From rule 2)}. Given that the number of $\mathtt{I}$s in $x\mathtt{I}$
        is not divisible by three (our inductive hypothesis), we can easily see that the number of $\mathtt{I}$s in $x\mathtt{IU}$ is identical and therefore is similarly not divisible by three.
        
        \emph{Inductive case (From rule 3)}. Let $n$ be the number of $\mathtt{I}$s in $\mathtt{M}x$. Our inductive hypothesis is that $3 \nmid n$. The number of $\mathtt{I}$s in $\mathtt{M}x x$, clearly $2n$, is similarly indivisible, i.e $3 \nmid n$ implies $3 \nmid 2n$. 
        
        \emph{Inductive case (From rule 4)}. Let $n$ be the number of $\mathtt{I}$s in $x\mathtt{III}y$. Our inductive hypothesis is that $3 \nmid n$. The number of $\mathtt{I}$s in $x \mathtt{U} y$, clearly $n - 3$, is similarly indivisible, i.e $3 \nmid n$ implies $3 \nmid (n-3)$
        
        \emph{Inductive case (From rule 5)}. Given that the number of $\mathtt{I}$s in $x\mathtt{UU}y$ is the same as the number of $\mathtt{I}$s in $x y$, our inductive hypothesis trivially proves our goal.
        
        \medskip
        
        Thus, by induction, no string in $\textsf{\textbf{Miu}}$ has a number of $\mathtt{I}$s divisible by three. Therefore, $\pred{\mathtt{MU}}{\textsf{\textbf{Miu}}}$ is not admissible.        
      \end{proof}
\end{ExerciseList}

\bigskip

\noindent Here is another language, which we'll call \textsf{\textbf{Mi}}:
    \begin{displaymath}
      \inferrule{\ }{\pred{\mathtt{MI}}{\textsf{\textbf{Mi}}}}{A} \quad \inferrule{\pred{\mathtt{M}x}{\textsf{\textbf{Mi}}}}{\pred{\mathtt{M}x x}{\textsf{\textbf{Mi}}}}{B} \quad
      \inferrule{\pred{x\mathtt{IIIIII}y}{\textsf{\textbf{Mi}}}}{\pred{xy}{\textsf{\textbf{Mi}}}}{C}
    \end{displaymath}
    
\begin{ExerciseList}
      \Exercise Prove using rule induction that all strings in $\textsf{\textbf{Mi}}$ could be expressed as follows, for some $k$ and some $i$, where $2^k - 6i > 0$ (and $\mathtt{C}^n$ is shorthand for the character $\mathtt{C}$ repeated $n$ times):
      \begin{displaymath}
        \mathtt{M}\:\mathtt{I}^{2^k - 6i}
      \end{displaymath}
      \Answer By rule induction on the premise:

        \begin{proof}[Base case (From rule A)] $\;\mathtt{MI} = \mathtt{M\:I}^{2^k - 6i}$ when $2^k - 6i = 1$, i.e when $k = 0$ and $i = 0$.
          
          \medskip
          
          \emph{Inductive case (From rule B)}. Given that $\mathtt{M} x = \mathtt{MI}^{2^a - 6b}$ (our inductive hypothesis), we must show that $\mathtt{M} x x = \mathtt{M\:I}^{2^k - 6i}$ for some $k$ and some $i$. As $x = \mathtt{I}^{2^a - 6b}$ (from I.H), it is easy to see that $x x = \mathtt{I}^{2 (2^a - 6b)} = \mathtt{I}^{2^{a + 1} - 6(2b)} = \mathtt{I}^{2^k - 6i}$ for $k = a + 1$ and $i = 2b$.
          
          \medskip
          
          \emph{Inductive case (from rule C)}. Given that $x \mathtt{IIIIII} y = \mathtt{M\:I}^{2^a - 6b}$ (our inductive hypothesis). We must show that $x y = \mathtt{M\:I}^{2^k - 6i}$ for some $k$ and $i$. It should be clear to see that this rule simply subtracts six $\mathtt{I}$ characters, and therefore $x y = \mathtt{MI}^{2^a - 6(b + 1)}$, hence $k = a$ and $i = b + 1$.
          
          \bigskip
          
          Thus, all strings in $\textsf{\textbf{Mi}}$ can be expressed as $\mathtt{M\:I}^{2^k - 6i}$ where $2^k - 6i > 0$
        \end{proof}

      \Exercise Now prove the opposite claim that, for all $k$ and $i$, assuming $2^k - 6i > 0$:
      \begin{displaymath}
        \pred{\mathtt{M}\:\mathtt{I}^{2^k - 6i}}{\textsf{\textbf{Mi}}}
      \end{displaymath}
      You should decompose the proof into two lemmas, and prove them separately:
      
        \Question Prove, using induction on the natural number $k$ (i.e when $k = 0$ and when $k = k' + 1$), that $\pred{\mathtt{M}\:\mathtt{I}^{2^k}}{\textsf{\textbf{Mi}}}$
        \Question Prove, using induction on the natural number $i$, that $\pred{\mathtt{M}\:\mathtt{I}^{k}}{\textsf{\textbf{Mi}}}$ implies $\pred{\mathtt{M}\:\mathtt{I}^{k - 6i}}{\textsf{\textbf{Mi}}}$, assuming $k - 6i > 0$.
        \ExeText
        As $\pred{\mathtt{M\:I}^{2^k}}{\textsf{\textbf{Mi}}}$ for all $k$ is established by lemma 1, you can conclude from lemma 2 that $\pred{\mathtt{M\:I}^{2^k - 6i}}{\textsf{\textbf{Mi}}}$ for all $k$ and all $i$ where $2^k - 6i > 0$, as required.

      \Answer 
          $\; $
          \medskip \begin{enumerate}
           \item$\;$ By structural induction on the natural number $k$:

\begin{proof}[Base case (when $k = 0$)] We have to show $\pred{\mathtt{MI}}{\textsf{\textbf{Mi}}}$, which is true by rule A.
            
            \emph{Inductive case (when $k = k' + 1$)} We have to show $\pred{\mathtt{MI}^{2^{k' + 1}}}{\textsf{\textbf{Mi}}}$, with the inductive hypothesis that
             $\pred{\mathtt{MI}^{2^{k'}}}{\textsf{\textbf{Mi}}}$. Equivalently, we have to show $\pred{\mathtt{MI}^{2^{k'}} \mathtt{I}^{2^{k'}}}{\textsf{\textbf{Mi}}}$, as follows:
             \begin{displaymath}
             \inferrule{\inferrule{\ }{\pred{\mathtt{MI}^{2^{k'}}}{\textsf{\textbf{Mi}}}}{I.H}}{\pred{\mathtt{MI}^{2^{k'}} \mathtt{I}^{2^{k'}}}{\textsf{\textbf{Mi}}}}{B}
           \end{displaymath}
           Therefore, by induction on the natural number $k$, we have shown $\forall k. \pred{\mathtt{M}\:\mathtt{I}^{2^k}}{\textsf{\textbf{Mi}}}$.
          \end{proof}
          \item $\;$By induction on the natural number $i$:

\begin{proof}[Base case (when $i = 0$)] We must show that $\pred{\mathtt{M}\:\mathtt{I}^k}{\textsf{\textbf{Mi}}}$ implies $\pred{\mathtt{M}\:\mathtt{I}^{k - 0}}{\textsf{\textbf{Mi}}}$, which is obviously a tautology.
            
            \emph{Inductive case (when $i = i' + 1$)} We must show that $\pred{\mathtt{M}\:\mathtt{I}^k}{\textsf{\textbf{Mi}}}$ implies $\pred{\mathtt{M}\:\mathtt{I}^{k - 6(i' + 1)}}{\textsf{\textbf{Mi}}}$, given the inductive hypothesis that $\pred{\mathtt{M}\:\mathtt{I}^{k - 6i'}}{\textsf{\textbf{Mi}}}$. Note that our I.H can be restated as $\pred{\mathtt{MIIIIII\:I}^{k - 6(i' + 1)}}{\textsf{\textbf{Mi}}}$ due to our assumption that $k - 6(i' + 1) > 0$. With this, we can prove our goal as shown:
            \begin{displaymath}
               \inferrule{\inferrule{\ }{\pred{\mathtt{MIIIIII\:I}^{k - 6(i' + 1)}}{\textsf{\textbf{Mi}}}}{I.H}}{\pred{\mathtt{M\:I}^{k - 6(i' + 1)}}{\textsf{\textbf{Mi}}}}{C}
             \end{displaymath}
          \end{proof}
          \end{enumerate}
      
\end{ExerciseList}      

\medskip

\noindent This completes the proof that the language $\textsf{\textbf{Mi}}$ is exactly characterised by the formulation $\mathtt{M\:I}^{2^k - 6i}$ where $2^k - 6i > 0$. A very neat result!

\medskip

\begin{ExerciseList}
      \Exercise Hence prove or disprove that the following rule is admissible in $\textsf{\textbf{Mi}}$:
      \begin{displaymath}
        \inferrule{\pred{\mathtt{M} x x}{\textsf{\textbf{Mi}}}}{\pred{\mathtt{M} x}{\textsf{\textbf{Mi}}}}{\textsf{\bf Lem}_1}
      \end{displaymath}
      \Answer
        We know from part i that $\pred{\mathtt{M} x x}{\textsf{\textbf{Mi}}} $ implies ${x ^ 2} = \mathtt{I}^{2^k - 6i}$
         for some $k$ and some $i$ where $2^k - 6i > 0$.

        This rule is \emph{not admissible} as it adds strings to the language. As $2^4 - 6 = 10$, we know $\mathtt{MI}^{10}$ is in the language. This rule would make $\mathtt{MI}^5$ a string in the language
        which it is not as there is no $k$ and $i$ such that $2^k - 6i = 5$.

      \Exercise Why is the following rule \textbf{not} admissible in $\textsf{\textbf{Mi}}$?
      \begin{displaymath}
        \inferrule{\pred{x y}{\textsf{\textbf{Mi}}}}{\pred{x \mathtt{IIIIII} y}{\textsf{\textbf{Mi}}}}{\textsf{\bf Lem}_2}
      \end{displaymath}
      \Answer
        The rule is not admissible as it adds strings to the language. This allows us to \emph{add} six $\mathtt{I}$ characters to any string in $\textsf{\textbf{Mi}}$ and judge it in $\textsf{\textbf{Mi}}$, which results in additional strings. For example, applying the rule to $\te{MI}$ (which is in \textsf{\textbf{Mi}}), gives us $\mathtt{M\:I}^7$, when our existing formulation of \textsf{\textbf{Mi}} ($\mathtt{M\:I}^{2^k - 6i}$) clearly only allows for even amounts of $\mathtt{I}$s.
      \Exercise[difficulty = 1] Prove that, for all $s$, $\pred{s}{\textsf{\textbf{Mi}}}$ implies $\pred{s}{\textsf{\textbf{Miu}}}$. Note that using straightforward rule induction appears to necessitate $\textsf{\bf Lem}_2$ above, which we know is not admissible. Try proving using the characterisation we have already developed.
    \Answer
      We shall show that all strings in $\textsf{\textbf{Mi}}$, characterised by $\mathtt{M\:I}^{2^k - 6i}$ where $2^k - 6i > 0$, are also in $\textsf{\textbf{Miu}}$. That is, we shall show that $\pred{\mathtt{M\:I}^{2^k - 6i}}{\textsf{\textbf{Miu}}}$.
      
      To start, we shall prove inductively on $k$ that $\pred{\mathtt{M\:I}^{2^k}}{\textsf{\textbf{Miu}}}$ for all $k$.
      
      \begin{proof}[Base case (Where $k = 0$)]$\;$ We must show $\pred{\mathtt{MI}}{\textsf{\textbf{Miu}}}$, which we know trivially from rule 1.
      
      \emph{Inductive case (where $k = k' + 1$)}. We must show $\pred{\mathtt{M\:I}^{2^{k' + 1}}}{\textsf{\textbf{Miu}}}$, given the inductive hypothesis that $\pred{\mathtt{M\:I}^{2^{k'}}}{\textsf{\textbf{Miu}}}$. Note we can restate our proof goal as $\pred{\mathtt{M\:I}^{2^{k'}}\mathtt{I}^{2^{k'}}}{\textsf{\textbf{Miu}}}$
      
      \begin{displaymath}        \inferrule{\inferrule{\ }{\pred{\mathtt{M\:I}^{2^{k'}}}{\textsf{\textbf{Miu}}}}{I.H}}{\pred{\mathtt{M\:I}^{2^{k'}}\mathtt{I}^{2^{k'}}}{\textsf{\textbf{Miu}}}}{B}
      \end{displaymath}
      
      \medskip
      
      Thus we have shown by induction that $\pred{\mathtt{M\:I}^{2^k}}{\textsf{\textbf{Miu}}}$ for all $k$.
      
      \bigskip
      
      Next we must prove that $\pred{\mathtt{M\:I}^{k}}{\textsf{\textbf{Miu}}}$ implies $\pred{\mathtt{M\:I}^{k - 6i}}{\textsf{\textbf{Miu}}}$ for all $i$, assuming $k - 6i > 0$.
      
      \medskip
      
      \emph{Base case (where $i = 0$)}. We must show that  $\pred{\mathtt{M\:I}^{k}}{\textsf{\textbf{Miu}}}$ implies $\pred{\mathtt{M\:I}^{k - 0}}{\textsf{\textbf{Miu}}}$, which is trivially a tautology.
      
      \emph{Inductive case (where $i = i' + 1$)}. we must show that $\pred{\mathtt{M\:I}^{k - 6(i' + 1)}}{\textsf{\textbf{Miu}}}$ given the inductive hypothesis $\pred{\mathtt{M\:I}^{k - 6i'}}{\textsf{\textbf{Miu}}}$. As we know $k - 6(i' + 1) > 0$, we can restate our inductive hypothesis as $\pred{\mathtt{MIIIIII\:I}^{k - 6(i' + 1)}}{\textsf{\textbf{Miu}}}$, and easily prove our goal:
      
      \begin{displaymath}
        \inferrule{\inferrule{\inferrule{\inferrule{\ }{\pred{\mathtt{MIIIIII\:I}^{k - 6(i' + 1)}}{\textsf{\textbf{Miu}}}}{I.H}}
            {\pred{\mathtt{MUIII\:I}^{k - 6(i' + 1)}}{\textsf{\textbf{Miu}}}}{4}}
            {\pred{\mathtt{MUU\:I}^{k - 6(i' + 1)}}{\textsf{\textbf{Miu}}}}{4}}
            {\pred{\mathtt{M\:I}^{k - 6(i' + 1)}}{\textsf{\textbf{Miu}}}}{5}
      \end{displaymath}

      Thus, as $\pred{\mathtt{M\:I}^{k}}{\textsf{\textbf{Miu}}}$ implies $\pred{\mathtt{M\:I}^{k - 6i}}{\textsf{\textbf{Miu}}}$, and $\pred{\mathtt{M\:I}^{2^k}}{\textsf{\textbf{Miu}}}$, we can see that $\pred{\mathtt{M\:I}^{2^k - 6i}}{\textsf{\textbf{Miu}}}$ for all $k$ and $i$ where $2^k - 6i > 0$. As this is the exact characterisation of $\textsf{\textbf{Mi}}$, we have proven that $\pred{s}{\textsf{\textbf{Mi}}} \vdash \pred{s}{\textsf{\textbf{Miu}}}$ for all $s$.
    \end{proof}
\end{ExerciseList}
\subsection*{Counting Sticks}

The following language (also presented in a similar form by Douglas Hofstadter, but the original invention is not his) is called the $\Phi\Psi$ system. Unlike the $\textsc{Miu}$ language discussed above, this language is not comprised of a single judgement, but of a ternary \emph{relation}, written $x\ \Phi\ y\ \Psi\ z$, where $x$, $y$ and $z$ are strings of hyphens (i.e `\te{-}'), which may be empty ($\epsilon$). The system is defined as follows:
  \begin{displaymath}
    \inferrule{\ }{\epsilon\ \Phi\ x \Psi\ x}{B} \quad \inferrule{x\ \Phi\ y\ \Psi\ z}{\te{-}x\ \Phi\ y\ \Psi\ \te{-}z}{I}
  \end{displaymath}

\begin{ExerciseList}
\Exercise Prove that $\te{--}\ \Phi\ \te{---}\ \Psi\ \te{-----}$.
\Answer
      \begin{displaymath}
       \inferrule{\inferrule{\inferrule{\ }{\epsilon\ \Phi\ \te{---} \ \Psi\ \te{---}}{B}}
             {\te{-}\ \Phi\ \te{---} \ \Psi\ \te{----}}{I}}
             {\te{--}\ \Phi\ \te{---} \ \Psi\ \te{-----}}{I}
      \end{displaymath}

\Exercise Is the following rule admissible? Is it derivable? Explain your answer
    \begin{displaymath}
      \inferrule{\te{-}x\ \Phi\ y\ \Psi\ \te{-}z}{x\ \Phi\ y\ \Psi\ z}{I'}
    \end{displaymath}
\Answer
      It is not derivable (as it cannot be shown with a proof tree), but it is admissible. We know this because the language definition for $\Phi\Psi$ is unambiguous, so the only way for $\te{-}x\ \Phi\ y\ \Psi\ \te{-}z$ to hold is if this was established by rule $I$. Therefore, we can deduce that $x\ \Phi\ y\ \Psi\ z$, as this is the premise of rule $I$. We can often ``flip'' or invert rules in this way, but \emph{only if the language definition is unambiguous}.

\Exercise Show that $x\ \Phi\ \epsilon\ \Psi\ x$, for all hyphen strings $x$, by doing induction on the length of the hyphen string (where $x = \epsilon$ and $x = \te{-}x'$).
\Answer
        \begin{proof}[Base case (where $x = \epsilon$)]$;$ We must show that $\epsilon\ \Phi\ \epsilon\ \Psi\ \epsilon$, which is trivially true by rule $B$.
          
          \emph{Inductive case (where $x = \te{-}x'$)}. We have the inductive hypothesis $x'\ \Phi\ \epsilon\ \Psi\ x'$, and must show that $\te{-}x'\ \Phi\ \epsilon\ \Psi\ \te{-}x'$. Our goal trivially reduces to our induction hypothesis by rule $I$.
          
          Therefore we have shown $x\ \Phi\ \epsilon\ \Psi\ x$ for all $x$ by induction on $x$.
        \end{proof}

\Exercise Show that if $\te{-}x\ \Phi\ y\ \Psi\ z$ then $x\ \Phi\ \te{-}y\ \Psi\ z$, for all hyphen strings $x$, $y$ and $z$, by doing a rule induction on the premise.
\Answer By rule induction on the premise  $\te{-}x\ \Phi\ y\ \Psi\ z$.
        
        \begin{proof}[Base case (From rules B and I, where $\te{-}\ \Phi\ y\ \Psi\ \te{-}y$) ]$;$ We must show that $\epsilon\ \Phi\ \te{-}y\ \Psi\ \te{-}y$, which is trivially true by rule $B$.
          
          \emph{Inductive case  (From rule I, where $\te{--}x'\ \Phi\ y\ \Psi\ \te{-}z'\ (*)$)}. We have the inductive hypothesis:
          \begin{displaymath}
            \inferrule{\te{-}x'\ \Phi\ y\ \Psi\ z'}{x'\ \Phi\ \te{-}y\ \Psi\ z'}{I.H}
          \end{displaymath}
          
          We must show that $\te{-}x'\ \Phi\ \te{-}y\ \Psi\ \te{-}z'$.
          
          \begin{displaymath}
            \inferrule{\inferrule{\inferrule{\inferrule{\ }{\te{--}x'\ \Phi\ y\ \Psi\ \te{-}z'}{(*)}}{\te{-}x'\ \Phi\ y\ \Psi\ z'}{I'}}{x'\ \Phi\ \te{-}y\ \Psi\ z'}{I.H}}{\te{-}x'\ \Phi\ \te{-}y\ \Psi\ \te{-}z'}{I}
          \end{displaymath}
          
          Thus we have shown by induction that  if $\te{-}x\ \Phi\ y\ \Psi\ z$ then $x\ \Phi\ \te{-}y\ \Psi\ z$, for all hyphen strings $x$, $y$ and $z$.
          
        \end{proof}
      
\Exercise Show that $x\ \Phi\ y\ \Psi\ z$ implies $y\ \Phi\ x\ \Psi\ z$.
\Answer
        We show this by rule induction on the premise with the rules of $\Phi\Psi$. 
        \begin{proof}[Base case (From rule B, where $\epsilon\ \Phi\ y\ \Psi\ y$)]$;$ We must show that $y\ \Phi\ \epsilon\ \Psi\ y$. We proved this, most fortunately, above in part (c).
          
          \medskip
          
          \emph{Inductive case (From rule I, where $\te{-}x'\ \Phi\ y\ \Psi\ {-}z'\ (*)$ )}. We have the inductive hypothesis:
          \begin{displaymath} \inferrule{x'\ \Phi\ y\ \Psi\ z'}{y\ \Phi\ x'\ \Psi\ z'}{I.H} \end{displaymath} 
            
            We must show that $y\ \Phi\ \te{-}x'\ \Psi\ \te{-}z'$. 
          
          \begin{displaymath}            
            \inferrule{\inferrule{\inferrule{\inferrule{\inferrule{\ }{\te{-}x'\ \Phi\ y\ \Psi\ {-}z'}{(*)}}{x'\ \Phi\ y\ \Psi\ z'}{I'}}{y\ \Phi\ x'\ \Psi\ z'}{I.H}}
                     {\te{-}y\ \Phi\ x'\ \Psi\ \te{-}z'}{I}
                }
                {y\ \Phi\ \te{-}x'\ \Psi\ \te{-}z'}{(d)}
          \end{displaymath}
          
          Thus we have shown by induction that $x\ \Phi\ y\ \Psi\ z$ implies $y\ \Phi\ x\ \Psi\ z$.
        \end{proof}
        
      
\Exercise Have you figured out what the $\Phi\Psi$ system actually is? Prove that if $\te{-}^x\ \Phi\ \te{-}^y\ \Psi\ \te{-}^z$, then $z = \te{-}^{x+y}$ (where $\te{-}^x$ is a hyphen string of length $x$). 
\Answer
        We proceed by rule induction on the premise.
        
        \begin{proof}[Base case (From rule $B$, where $\te{-}^0\ \Phi\ \te{-}^y\ \Psi\ \te{-}^{y}$)]$;$ We must show that $\te{-}^0\ \Phi\ \te{-}^y\ \Psi\ \te{-}^{0+y}$. As $0 + y = y$, this trivially reduces to the premise.
          
          \emph{Inductive case (From rule $I$, where $\te{-}^{x' + 1}\ \Phi\ \te{-}^{y}\ \Psi\ \te{-}^{z' + 1}\ (*)$)}. We have the inductive hypothesis that $\te{-}^{x'}\ \Phi\ \te{-}^{y}\ \Psi\ \te{-}^{z'} \implies z' = x' + y$. We must show that $z' + 1 = (x' + 1) + y$, or, equivalently, that $z' = x' + y$:
          
          \begin{displaymath}
            \inferrule{\inferrule{\inferrule{\ }{\te{-}^{x' + 1}\ \Phi\ \te{-}^{y}\ \Psi\ \te{-}^{z' + 1}}{(*)}}{\te{-}^{x'}\ \Phi\ \te{-}^{y}\ \Psi\ \te{-}^{z'}}{I}}{z' = x' + y}{I.H}
          \end{displaymath}
          
          Thus we have shown by rule induction that the $\Phi\Psi$ system is in fact unary addition.
        \end{proof}
\end{ExerciseList}
\subsection*{Ambiguity and Simultaneity}
Here is a simple grammar for a functional programming language \footnote{if you're interested, it's called \emph{lambda calculus}, with \emph{de Bruijn indices} syntax, not that it's relevant to the question!}:
\begin{displaymath}
  \inferrule{x \in \mathbb{N}}{\pred{x}{Expr}}{\textsc{Var.}}\quad\inferrule{\predand{e_1}{Expr}\pred{e_2}{Expr}}{\pred{e_1 e_2}{Expr}}{\textsc{Appl.}}\quad\inferrule{\pred{e}{Expr}}{\pred{\lambda e}{Expr}}{\textsc{Abst.}}\quad\inferrule{\pred{e}{Expr}}{\pred{(e)}{Expr}}{\textsc{Paren.}}
  \end{displaymath}   
\begin{ExerciseList}
\Exercise Is this grammar ambiguous? If not, explain why not. If so, give an example of an expression that has multiple parse trees.
\Answer
    Yes, the expression $1\ 2\ 3$ could be parsed two different ways, i.e:
    \begin{displaymath}
      \inferrule{\inferrule{\inferrule{\ }{\pred{1}{Expr}}{\textsc{Var.}}
               \quad\inferrule{\ }{\pred{2}{Expr}}{\textsc{Var.}}
               }{\pred{1\ 2}{Expr}}{\textsc{Appl.}}\quad\inferrule{\ }{\pred{3}{Expr}}{\textsc{Var.}}}{\pred{1\ 2\ 3}{Expr}}{\textsc{Appl.}}
    \end{displaymath}
        Or:
    \begin{displaymath}
      \inferrule{\inferrule{\ }{\pred{1}{Expr}}{\textsc{Var.}}\quad\inferrule{\inferrule{\ }{\pred{2}{Expr}}{\textsc{Var.}}
               \quad\inferrule{\ }{\pred{3}{Expr}}{\textsc{Var.}}
               }{\pred{2\ 3}{Expr}}{\textsc{Appl.}}
          }{\pred{1\ 2\ 3}{Expr}}{\textsc{Appl.}}
    \end{displaymath}

\Exercise Develop a new (unambiguous) grammar that encodes the left associativity of application, that is $1\ 2\ 3\ 4$ should be parsed as $((1\ 2)\ 3)\ 4$ (modulo parentheses). Furthermore, lambda expressions should extend as far as possible, i.e $\lambda 1\ 2$ is equivalent to $\lambda (1\ 2)$ not $(\lambda 1) 2$.
\Answer
    \begin{displaymath}
      \inferrule{x \in \mathbb{N}}{\pred{x}{AExpr}}{\textsc{AVar.}}\quad\inferrule{\predand{e_1}{PExpr}\pred{e_2}{AExpr}}{\pred{e_1 e_2}{PExpr}}{\textsc{AAppl.}}\quad\inferrule{\pred{e}{LExpr}}{\pred{\lambda e}{LExpr}}{\textsc{AAbs.}}
      \end{displaymath}
      \begin{displaymath} \inferrule{\pred{e}{LExpr}}{\pred{(e)}{AExpr}}{\textsc{AParen.}}y\quad\inferrule{\pred{e}{PExpr}}{\pred{e}{LExpr}}{\textsc{Shunt}_1} \quad\inferrule{\pred{e}{AExpr}}{\pred{e}{PExpr}}{\textsc{Shunt}_2}
      \end{displaymath}

\Exercise[difficulty=1] Prove that all expressions in your grammar are representable in $Expr$, that is, that your grammar describes only strings that are in $Expr$.
\Answer
    We shall prove the following simultaneously:
    \begin{enumerate}
      \item $\; \pred{x}{LExpr} \Rightarrow \pred{x}{Expr}$
      \item $\; \pred{x}{PExpr} \Rightarrow \pred{x}{Expr}$
      \item $\; \pred{x}{AExpr} \Rightarrow \pred{x}{Expr}$
    \end{enumerate}
    \begin{proof}[Base case (From rule $\textsc{AVar.}$, where $\pred{x}{AExpr}$ for some $x \in \mathbb{N}$)] $\;$ We must show $\pred{x}{Expr}$, trivial by rule $\textsc{Var.}$
      
      \emph{Inductive case (From rule $\textsc{AAppl.}$, where $\pred{e_1 e_2}{PExpr}$)}.. By inversion on rule $\textsc{AAppl.}$, we deduce $\pred{e_1}{PExpr}\ (*)$, and $\pred{e_2}{AExpr}\ (**)$.
     We have the inductive hypotheses $\pred{e_1}{AExpr} \lor \pred{e_1}{PExpr} \lor \pred{e_1}{LExpr} \implies \pred{e_1}{Expr}\ (\textsc{I.H}_1)$ and  $\pred{e_2}{AExpr} \lor \pred{e_2}{PExpr} \lor \pred{e_2}{LExpr} \implies \pred{e_2}{Expr}\ (\textsc{I.H}_2)$. By lifting the three disjunctions out of the implications, we get six implications, essentially saying that if $e_1$ or $e_2$ is either $PExpr$, $LExpr$, or $AExpr$, then it is $Expr$.
     
      We must show that $\pred{e_1 e_2}{Expr}$.
      
      \begin{displaymath}
        \inferrule{\inferrule{\inferrule{\ }{\pred{e_1}{LExpr}}{(*)}}{\pred{e_1}{Expr}}{IH_1}\quad\inferrule{\inferrule{\ }{\pred{e_2}{AExpr}}{(**)}}{\pred{e_2}{Expr}}{IH_2}}{\pred{e_1 e_2}{Expr}}
      \end{displaymath}
      \medskip
      
      \emph{Inductive case (From rule $\textsc{AAbs.}$, where $\pred{\lambda x}{LExpr}$)}. We can deduce by inversion of rule \textsc{AAbs.} that $\pred{x}{LExpr}$. Applying one of our inductive hypotheses $\pred{x}{LExpr} \implies \pred{x}{Expr}$ to this, we can deduce that $\pred{x}{Expr}$, and then we can apply forwards the rule \textsc{Abs.} to prove our goal: $\pred{\lambda x}{Expr}$.
      \medskip
      
      \emph{Inductive case (From rule $\textsc{AParen.}$, where $\pred{(x)}{AExpr}$)}. We can deduce by inversion that $\pred{x}{LExpr}$. Using one of the I.H, we get $\pred{x}{Expr}$, then by rule \textsc{Paren.} we show our goal $\pred{(x)}{Expr}$.
      \medskip
      
      The inductive case for the rules $\textsc{Shunt}_1$ and $\textsc{Shunt}_2$ are trivial as they do not alter the expression.
      \bigskip
      
      Thus, by induction, $\pred{s}{LExpr} \lor \pred{s}{PExpr} \lor \pred{s}{AExpr} \implies \pred{s}{Expr}$. We can state this more succinctly thanks to the \textsc{Shunt} rules as $\pred{s}{LExpr} \implies \pred{s}{Expr}$.
      \end{proof}
\end{ExerciseList}
\subsection*{Solutions}
\shipoutAnswer
      

\end{verbatim}
\end{document}
